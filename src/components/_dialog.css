/**
 * Symphony CSS Framework v2.0
 * Dialog - Native Dialog Element Styling
 * 
 * Philosophy:
 * - Use native <dialog> element (no JavaScript framework needed)
 * - Accessible by default (focus trapping, escape to close)
 * - Data attributes for variants
 * - Backdrop styling included
 * 
 * Usage:
 *   <dialog class="dialog">
 *     <header>Dialog Title</header>
 *     <div class="dialog-body">Content</div>
 *     <footer>
 *       <button data-variant="ghost" onclick="this.closest('dialog').close()">Cancel</button>
 *       <button data-variant="primary">Confirm</button>
 *     </footer>
 *   </dialog>
 * 
 * JavaScript (minimal):
 *   dialog.showModal() // Open
 *   dialog.close()     // Close
 */

@layer symphony.components {
    /* =============================================
     NATIVE DIALOG BASE
     ============================================= */

    :where(dialog),
    :where(.dialog) {
        /* Reset browser defaults */
        padding: 0;
        border: none;
        background: transparent;

        /* Positioning */
        position: fixed;
        inset: 0;
        margin: auto;
        max-inline-size: min(90vw, var(--dialog-width, 32rem));
        max-block-size: min(90vh, var(--dialog-height, fit-content));

        /* Appearance */
        background-color: var(--symphony-surface);
        border-radius: var(--symphony-radius-lg);
        box-shadow: var(--symphony-shadow-xl);
        overflow: hidden;

        /* Animation */
        opacity: 0;
        transform: scale(0.95) translateY(-10px);
        transition: opacity var(--symphony-duration-normal) var(--symphony-ease-out),
            transform var(--symphony-duration-normal) var(--symphony-ease-out),
            display var(--symphony-duration-normal) var(--symphony-ease-out) allow-discrete,
            overlay var(--symphony-duration-normal) var(--symphony-ease-out) allow-discrete;

        /* When open */
        &[open] {
            opacity: 1;
            transform: scale(1) translateY(0);

            @starting-style {
                opacity: 0;
                transform: scale(0.95) translateY(-10px);
            }
        }

        /* =========================================
       DIALOG SECTIONS
       ========================================= */

        &>header,
        & .dialog-header {
            padding: var(--symphony-space-lg);
            border-block-end: 1px solid var(--symphony-border);

            & h1,
            & h2,
            & h3,
            & h4,
            & h5,
            & h6 {
                margin: 0;
                font-size: var(--symphony-text-xl);
                font-weight: var(--symphony-font-semibold);
                line-height: var(--symphony-leading-tight);
            }

            & p {
                margin: 0;
                margin-block-start: var(--symphony-space-2xs);
                color: var(--symphony-text-muted);
                font-size: var(--symphony-text-sm);
            }
        }

        & .dialog-body,
        &> :not(header):not(footer):not(.dialog-header):not(.dialog-footer) {
            padding: var(--symphony-space-lg);
            overflow-y: auto;
            overscroll-behavior: contain;
        }

        &>footer,
        & .dialog-footer {
            padding: var(--symphony-space-lg);
            border-block-start: 1px solid var(--symphony-border);
            background-color: var(--symphony-surface-hover);

            display: flex;
            justify-content: flex-end;
            gap: var(--symphony-space-sm);
            flex-wrap: wrap;
        }
    }

    /* =============================================
     DIALOG BACKDROP
     ============================================= */

    :where(dialog)::backdrop,
    :where(.dialog)::backdrop {
        background-color: oklch(0% 0 0 / 0.5);
        backdrop-filter: blur(4px);

        /* Animation */
        opacity: 0;
        transition: opacity var(--symphony-duration-normal) var(--symphony-ease-out),
            display var(--symphony-duration-normal) var(--symphony-ease-out) allow-discrete,
            overlay var(--symphony-duration-normal) var(--symphony-ease-out) allow-discrete;
    }

    :where(dialog[open])::backdrop {
        opacity: 1;

        @starting-style {
            opacity: 0;
        }
    }

    /* =============================================
     DIALOG SIZE VARIANTS
     data-size="sm|lg|xl|full"
     ============================================= */

    :where(dialog[data-size="sm"]),
    :where(.dialog[data-size="sm"]) {
        --dialog-width: 24rem;
    }

    :where(dialog[data-size="lg"]),
    :where(.dialog[data-size="lg"]) {
        --dialog-width: 48rem;
    }

    :where(dialog[data-size="xl"]),
    :where(.dialog[data-size="xl"]) {
        --dialog-width: 64rem;
    }

    :where(dialog[data-size="full"]),
    :where(.dialog[data-size="full"]) {
        --dialog-width: 95vw;
        --dialog-height: 95vh;
    }

    /* =============================================
     ALERT/CONFIRM DIALOGS
     data-type="alert|confirm|destructive"
     ============================================= */

    :where(dialog[data-type="alert"]),
    :where(.dialog[data-type="alert"]) {
        --dialog-width: 28rem;
        text-align: center;

        &>header,
        & .dialog-header {
            border: none;
            padding-block-end: var(--symphony-space-sm);
        }

        & .dialog-body {
            padding-block-start: 0;
        }

        &>footer,
        & .dialog-footer {
            justify-content: center;
            border: none;
            background: transparent;
        }
    }

    :where(dialog[data-type="destructive"]),
    :where(.dialog[data-type="destructive"]) {

        &>header h1,
        &>header h2,
        &>header h3 {
            color: var(--symphony-danger);
        }
    }

    /* =============================================
     SLIDE-IN DRAWER VARIANT
     data-position="right|left|bottom|top"
     ============================================= */

    :where(dialog[data-position="right"]),
    :where(.dialog[data-position="right"]) {
        margin: 0;
        margin-inline-start: auto;
        max-inline-size: min(90vw, 24rem);
        max-block-size: 100vh;
        block-size: 100vh;
        border-radius: 0;

        transform: translateX(100%);

        &[open] {
            transform: translateX(0);

            @starting-style {
                transform: translateX(100%);
            }
        }
    }

    :where(dialog[data-position="left"]),
    :where(.dialog[data-position="left"]) {
        margin: 0;
        margin-inline-end: auto;
        max-inline-size: min(90vw, 24rem);
        max-block-size: 100vh;
        block-size: 100vh;
        border-radius: 0;

        transform: translateX(-100%);

        &[open] {
            transform: translateX(0);

            @starting-style {
                transform: translateX(-100%);
            }
        }
    }

    :where(dialog[data-position="bottom"]),
    :where(.dialog[data-position="bottom"]) {
        margin: 0;
        margin-block-start: auto;
        max-inline-size: 100vw;
        inline-size: 100vw;
        max-block-size: 80vh;
        border-radius: var(--symphony-radius-xl) var(--symphony-radius-xl) 0 0;

        transform: translateY(100%);

        &[open] {
            transform: translateY(0);

            @starting-style {
                transform: translateY(100%);
            }
        }
    }

    /* =============================================
     CLOSE BUTTON (Optional)
     ============================================= */

    .dialog-close {
        position: absolute;
        inset-block-start: var(--symphony-space-md);
        inset-inline-end: var(--symphony-space-md);
        padding: var(--symphony-space-xs);
        border-radius: var(--symphony-radius-md);

        &:hover {
            background-color: var(--symphony-surface-hover);
        }
    }
}