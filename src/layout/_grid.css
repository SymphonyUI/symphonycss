/**
 * Symphony CSS Framework v2.0
 * Grid System - Intrinsically Responsive CSS Grid
 * 
 * Philosophy:
 * - NO 12-column grid (obsolete with modern CSS Grid)
 * - Intrinsic sizing with auto-fit/auto-fill
 * - Container queries for component-level responsiveness
 * - Data attributes for column hints
 * - Zero media queries needed for basic responsive behavior
 * 
 * Why NO 12-Column Grid:
 * 1. CSS Grid makes fixed columns unnecessary
 * 2. Inflexible fixed columns limit modern responsive design
 * 3. Classes like .col-md-6 are not semantic
 * 4. Adds 10-15KB for features CSS Grid does natively
 * 5. Complex class combinations confuse AI code generators
 * 
 * Usage:
 *   <div class="grid">...</div>
 *   <div class="grid" data-columns="2">...</div>
 *   <div class="grid" data-columns="3">...</div>
 *   <div class="grid" data-layout="sidebar">...</div>
 */

@layer symphony.layout {
  /* =============================================
     INTRINSIC RESPONSIVE GRID
     Uses auto-fit with minmax() for automatic responsiveness
     ============================================= */

  .grid {
    display: grid;
    gap: var(--grid-gap, var(--symphony-space-lg));
    grid-template-columns: repeat(auto-fit,
        minmax(min(100%, var(--grid-min-width, 20rem)), 1fr));
  }

  /* =============================================
     COLUMN HINTS (Data Attributes)
     Suggests minimum widths for different column counts
     Still intrinsically responsive!
     ============================================= */

  /* 2 columns - larger minimum width */
  .grid[data-columns="2"] {
    --grid-min-width: 25rem;
  }

  /* 3 columns - medium minimum width */
  .grid[data-columns="3"] {
    --grid-min-width: 18rem;
  }

  /* 4 columns - smaller minimum width */
  .grid[data-columns="4"] {
    --grid-min-width: 14rem;
  }

  /* 5+ columns - very small minimum */
  .grid[data-columns="5"],
  .grid[data-columns="6"] {
    --grid-min-width: 10rem;
  }

  /* =============================================
     FIXED COLUMN GRIDS (When needed)
     Use sparingly - intrinsic is usually better
     ============================================= */

  .grid[data-fixed="2"] {
    grid-template-columns: repeat(2, 1fr);
  }

  .grid[data-fixed="3"] {
    grid-template-columns: repeat(3, 1fr);
  }

  .grid[data-fixed="4"] {
    grid-template-columns: repeat(4, 1fr);
  }

  /* =============================================
     SPECIAL LAYOUTS
     Common layout patterns as data attributes
     ============================================= */

  /* Sidebar layout: sidebar + main content */
  .grid[data-layout="sidebar"] {
    grid-template-columns: minmax(15rem, 20rem) 1fr;

    @container container (max-width: 60ch) {
      grid-template-columns: 1fr;
    }
  }

  /* Sidebar right: main content + sidebar */
  .grid[data-layout="sidebar-right"] {
    grid-template-columns: 1fr minmax(15rem, 20rem);

    @container container (max-width: 60ch) {
      grid-template-columns: 1fr;
    }
  }

  /* Holy grail: sidebar + main + sidebar */
  .grid[data-layout="holy-grail"] {
    grid-template-columns: minmax(12rem, 15rem) 1fr minmax(12rem, 15rem);

    @container container (max-width: 60ch) {
      grid-template-columns: 1fr;
    }
  }

  /* Featured: large item + smaller grid */
  .grid[data-layout="featured"] {
    grid-template-columns: 2fr 1fr;
    grid-template-rows: auto auto;

    &> :first-child {
      grid-row: span 2;
    }
  }

  /* Masonry-like: auto-placement with varying heights */
  .grid[data-layout="masonry"] {
    grid-template-columns: repeat(auto-fit, minmax(min(100%, 15rem), 1fr));
    grid-auto-rows: minmax(100px, auto);
    grid-auto-flow: dense;
  }

  /* =============================================
     GAP VARIANTS
     ============================================= */

  .grid[data-gap="none"] {
    --grid-gap: 0;
  }

  .grid[data-gap="sm"] {
    --grid-gap: var(--symphony-space-sm);
  }

  .grid[data-gap="lg"] {
    --grid-gap: var(--symphony-space-xl);
  }

  .grid[data-gap="xl"] {
    --grid-gap: var(--symphony-space-2xl);
  }

  /* =============================================
     GRID ITEM UTILITIES
     For spanning and placement
     ============================================= */

  /* Span multiple columns */
  [data-span="2"] {
    grid-column: span 2;
  }

  [data-span="3"] {
    grid-column: span 3;
  }

  [data-span="full"] {
    grid-column: 1 / -1;
  }

  /* Span multiple rows */
  [data-row-span="2"] {
    grid-row: span 2;
  }

  [data-row-span="3"] {
    grid-row: span 3;
  }

  /* =============================================
     SUBGRID SUPPORT
     For nested grids that align with parent
     ============================================= */

  .subgrid {
    display: grid;
    grid-template-columns: subgrid;
    grid-template-rows: subgrid;
  }

  /* =============================================
     CONTAINER QUERY RESPONSIVE GRID
     Grid that responds to container, not viewport
     ============================================= */

  .grid[data-responsive="container"] {
    container-type: inline-size;

    @container (max-width: 30rem) {
      grid-template-columns: 1fr;
    }

    @container (min-width: 30rem) and (max-width: 50rem) {
      grid-template-columns: repeat(2, 1fr);
    }

    @container (min-width: 50rem) {
      grid-template-columns: repeat(3, 1fr);
    }
  }

  /* =============================================
     LEGACY SUPPORT (Backward Compatibility)
     ============================================= */

  .symphony-grid {
    display: grid;
    gap: var(--symphony-space-lg);
    grid-template-columns: repeat(auto-fit, minmax(min(100%, 20rem), 1fr));
  }

  /* Legacy column spans still work */
  .symphony-col-span-full {
    grid-column: 1 / -1;
  }
}